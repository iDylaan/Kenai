import{B as y,s as k,a as b}from"./button.esm-mfXYsXE9.js";import{o as n,c as d,m as p,s as w,f as c,a as u,u as _,t as h,Q as B,g as f,E as I,_ as $,z as N,G as i,d as g,j as V,i as A,R as O,p as P,q as C,S as E}from"./index-BXR5_ARW.js";import{s as T}from"./avatar.esm-CPX_005g.js";var j={root:function(t){var r=t.instance;return["p-progressbar p-component",{"p-progressbar-determinate":r.determinate,"p-progressbar-indeterminate":r.indeterminate}]},container:"p-progressbar-indeterminate-container",value:"p-progressbar-value p-progressbar-value-animate",label:"p-progressbar-label"},x=y.extend({name:"progressbar",classes:j}),J={name:"BaseProgressBar",extends:k,props:{value:{type:Number,default:null},mode:{type:String,default:"determinate"},showValue:{type:Boolean,default:!0}},style:x,provide:function(){return{$parentInstance:this}}},S={name:"ProgressBar",extends:J,inheritAttrs:!1,computed:{progressStyle:function(){return{width:this.value+"%",display:"flex"}},indeterminate:function(){return this.mode==="indeterminate"},determinate:function(){return this.mode==="determinate"}}},D=["aria-valuenow"];function L(e,t,r,v,m,o){return n(),d("div",p({role:"progressbar",class:e.cx("root"),"aria-valuemin":"0","aria-valuenow":e.value,"aria-valuemax":"100"},e.ptmi("root")),[o.determinate?(n(),d("div",p({key:0,class:e.cx("value"),style:o.progressStyle},e.ptm("value")),[e.value!=null&&e.value!==0&&e.showValue?(n(),d("div",p({key:0,class:e.cx("label")},e.ptm("label")),[w(e.$slots,"default",{},function(){return[_(h(e.value+"%"),1)]})],16)):c("",!0)],16)):c("",!0),o.indeterminate?(n(),d("div",p({key:1,class:e.cx("container")},e.ptm("container")),[u("div",p({class:e.cx("value")},e.ptm("value")),null,16)],16)):c("",!0)],16,D)}S.render=L;const U=B("session",()=>{const e=f(null),t=f(null),r=I(()=>t.value!==null&&e.value!==null);return{user:e,token:t,isAuthenticated:r,login:async l=>{try{const a=await fetch("http://localhost:5000/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!a.ok)throw new Error(a.statusText);const s=await a.json();if(console.log(s),!s.success)throw new Error(s.error.message);return e.value=s.data.user,t.value=s.data.token,localStorage.setItem("kenai_token",s.data.token),localStorage.setItem("kenai_user",JSON.stringify(s.data.user)),s.success}catch(a){throw console.error("Error al iniciar sesiÃ³n:",a),a.message}},logout:()=>{e.value=null,t.value=null,localStorage.removeItem("kenai_token"),localStorage.removeItem("kenai_user")},loadSession:()=>{const l=localStorage.getItem("kenai_user"),a=localStorage.getItem("kenai_token");l&&a&&(e.value=JSON.parse(l),t.value=a)}}}),q=e=>(P("data-v-c85bf143"),e=e(),C(),e),z={class:"sso-main"},G={class:"sso__container"},M=q(()=>u("section",{class:"title__container"},[u("span",{class:"material-icons"},"person"),u("h1",{class:"title__text"},"Login")],-1)),Q={class:"form__container"},R={key:2,class:"authed__container"},F={class:"footer__container"},H={__name:"SSOView",setup(e){const t=U(),r=f(!1);N(()=>{t.loadSession()});const v=async m=>{r.value=!0;const o=E(m.credential);try{await t.login(o)}catch(l){console.log(l)}finally{r.value=!1}};return(m,o)=>{const l=b,a=T,s=S;return n(),d("main",z,[u("div",G,[M,u("section",Q,[i(t).isAuthenticated?c("",!0):(n(),g(i(O),{key:0,callback:v})),i(t).isAuthenticated?(n(),g(l,{key:1,onClick:o[0]||(o[0]=K=>i(t).logout())},{default:V(()=>[_("Logout")]),_:1})):c("",!0),i(t).isAuthenticated?(n(),d("div",R,[_(h(i(t).user.given_name)+" ",1),A(a,{image:i(t).user.picture,alt:"User Avatar",round:""},null,8,["image"])])):c("",!0)]),u("section",F,[r.value?(n(),g(s,{key:0,mode:"indeterminate",style:{height:"6px"}})):c("",!0)])])])}}},Z=$(H,[["__scopeId","data-v-c85bf143"]]);export{Z as default};
