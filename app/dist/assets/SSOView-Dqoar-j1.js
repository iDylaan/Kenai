import{B as T,s as E,a as V}from"./button.esm-C2y9lm43.js";import{o as n,c as d,m as g,s as x,f as c,a as t,u as f,t as w,Q as A,g as _,E as N,_ as S,d as v,j as k,T as P,p as b,q as B,z as M,i as y,G as u,F as j,R as C,S as L}from"./index-DzGnJMpq.js";import{s as O}from"./avatar.esm-DMSLOiR0.js";var Z={root:function(a){var i=a.instance;return["p-progressbar p-component",{"p-progressbar-determinate":i.determinate,"p-progressbar-indeterminate":i.indeterminate}]},container:"p-progressbar-indeterminate-container",value:"p-progressbar-value p-progressbar-value-animate",label:"p-progressbar-label"},J=T.extend({name:"progressbar",classes:Z}),q={name:"BaseProgressBar",extends:E,props:{value:{type:Number,default:null},mode:{type:String,default:"determinate"},showValue:{type:Boolean,default:!0}},style:J,provide:function(){return{$parentInstance:this}}},$={name:"ProgressBar",extends:q,inheritAttrs:!1,computed:{progressStyle:function(){return{width:this.value+"%",display:"flex"}},indeterminate:function(){return this.mode==="indeterminate"},determinate:function(){return this.mode==="determinate"}}},z=["aria-valuenow"];function D(e,a,i,p,h,l){return n(),d("div",g({role:"progressbar",class:e.cx("root"),"aria-valuemin":"0","aria-valuenow":e.value,"aria-valuemax":"100"},e.ptmi("root")),[l.determinate?(n(),d("div",g({key:0,class:e.cx("value"),style:l.progressStyle},e.ptm("value")),[e.value!=null&&e.value!==0&&e.showValue?(n(),d("div",g({key:0,class:e.cx("label")},e.ptm("label")),[x(e.$slots,"default",{},function(){return[f(w(e.value+"%"),1)]})],16)):c("",!0)],16)):c("",!0),l.indeterminate?(n(),d("div",g({key:1,class:e.cx("container")},e.ptm("container")),[t("div",g({class:e.cx("value")},e.ptm("value")),null,16)],16)):c("",!0)],16,z)}$.render=D;const F=A("session",()=>{const e=_(null),a=_(null),i=N(()=>a.value!==null&&e.value!==null),p=async r=>{try{const s=await fetch("http://localhost:5000/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok)throw new Error(s.statusText);const o=await s.json();if(console.log(o),!o.success)throw new Error(o.error.message);return e.value=o.data.user,a.value=o.data.token,localStorage.setItem("kenai_token",o.data.token),localStorage.setItem("kenai_user",JSON.stringify(o.data.user)),o.success}catch(s){throw console.error("Error al iniciar sesi贸n:",s),s.message}},h=()=>{e.value=null,a.value=null,localStorage.removeItem("kenai_token"),localStorage.removeItem("kenai_user")},l=async()=>{const r=localStorage.getItem("kenai_user"),s=localStorage.getItem("kenai_token");r&&s&&(a.value=s,await m()&&(e.value=JSON.parse(r)))},m=async()=>{try{const r=await fetch("http://localhost:5000/auth/jwt_check",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.value}`}});if(!r.ok)throw new Error(r.statusText);const s=await r.json();if(!s.success)throw new Error(s.error.message);if(!s.data.valid)throw new Error("La sesi贸n ha expirado. Inicia sesi贸n nuevamente.");return!0}catch(r){return console.error("Error al validar la sesi贸n:",r.message),h(),!1}};return{user:e,token:a,isAuthenticated:i,login:p,logout:h,loadSession:l}}),I=e=>(b("data-v-05e81aa8"),e=e(),B(),e),G={key:0,class:"loading-screen animate__animated"},U=I(()=>t("div",{class:"logo-container animate__animated"},[t("svg",{viewBox:"0 0 800 570",xmlns:"http://www.w3.org/2000/svg",class:"loader-logo"},[t("path",{class:"cls-1",d:"M614.36,476.01c-26.71-45.53-38.01-118.14-38.01-118.14-45.14,18.81-114.38,61.7-114.38,61.7,0,0,19.95,26.33,52.4,68.67,32.46,42.33,41.67,37.43,41.67,37.43h115.88c0-55.68-57.56-49.66-57.56-49.66Z"}),t("path",{class:"cls-1",d:"M400,133.32c0-19.11,15.5-34.61,34.61-34.61-9.55,0-18.21-3.88-24.48-10.15-6.25-6.25-10.13-14.92-10.13-24.48,0,9.56-3.88,18.23-10.13,24.48-6.27,6.27-14.93,10.15-24.48,10.15,9.55,0,18.21,3.88,24.48,10.13,6.25,6.27,10.13,14.92,10.13,24.48Z"}),t("path",{class:"cls-1",d:"M501.86,84.03c0-11.01,8.92-19.95,19.93-19.95-5.51,0-10.48-2.23-14.1-5.83-3.6-3.62-5.83-8.59-5.83-14.1,0,5.51-2.23,10.48-5.85,14.1-3.62,3.6-8.6,5.83-14.1,5.83,5.5,0,10.48,2.23,14.1,5.85s5.85,8.6,5.85,14.1Z"}),t("path",{class:"cls-1",d:"M726.71,246.04s-15.98-9.4-43.83-32.92c3.57-30.47-29.35-49.66-44.21-60.77.74-17.12-2.64-33.11-27.47-39.5-33.3-7.33-44.96,24.64-44.96,24.64-60.62-27.86-102.48-19.83-147.07-.35-44.59,19.46-56.73,11.85-82.13,10.72-119.37-30.2-159.16-7.06-204.86,27.94-45.72,34.99-51.83,100.18-43.65,138.85,12.42,26.81,3.4,38.1-3.95,68.29-3.66,11.56-12.7,40.63-12.13,83.81,3.95,53.63,42.05,58.93,42.05,58.93h105.25c0-44.35-34.7-47.55-34.7-47.55h-25.4c0-41.06,31.89-68.57,31.89-68.57,71.11.55,106.94-70.83,109.77-108.46,5.26,15.24,3.95,47.04,3.95,47.04,5.64-2.52,14.55-9.08,23.71-16.52,5.18,23.75-2.26,44.69-18.85,63.55-.98.76-1.97,1.52-2.96,2.3-1.53,1.21-3.09,2.41-4.72,3.47-28.3,18.59-16.77,52.07-10.13,70.89,17.5,52.49,46.42,53.84,46.42,53.84h112.18c3.09-33.16-23.12-49.54-61.88-49.54-11.28-63.58,37.63-83.91,53.61-95.19,74.88-50.23,152.96-69.05,152.96-69.05,0,0,35.18,7.35,64.9-.74,79.77-23.14,66.22-65.1,66.22-65.1ZM463.23,251.71c0-12.73-5.16-24.25-13.5-32.59-8.34-8.34-19.86-13.5-32.59-13.5,12.73,0,24.25-5.16,32.59-13.5,8.34-8.35,13.5-19.87,13.5-32.6,0,12.73,5.16,24.25,13.5,32.6,8.34,8.34,19.87,13.5,32.6,13.5-25.46,0-46.1,20.63-46.1,46.09ZM653.87,242.63c-6.31,0-11.43-5.42-11.43-12.13s5.12-12.13,11.43-12.13,11.42,5.42,11.42,12.13-5.12,12.13-11.42,12.13Z"})])],-1)),Q=I(()=>t("div",{class:"lights"},[t("div",{class:"light light1"}),t("div",{class:"light light2"}),t("div",{class:"light light3"})],-1)),R=[U,Q],H={__name:"PageLoader",props:{loading:{type:Boolean,required:!0}},setup(e){return(a,i)=>(n(),v(P,{name:"custom-fade"},{default:k(()=>[e.loading?(n(),d("div",G,R)):c("",!0)]),_:1}))}},K=S(H,[["__scopeId","data-v-05e81aa8"]]),W=e=>(b("data-v-d80008a2"),e=e(),B(),e),X={class:"sso-main"},Y={class:"sso__container"},ee=W(()=>t("section",{class:"title__container"},[t("span",{class:"material-icons"},"person"),t("h1",{class:"title__text"},"Login")],-1)),ae={class:"form__container"},te={key:2,class:"authed__container"},se={class:"footer__container"},re={__name:"SSOView",setup(e){const a=F(),i=_(!1),p=_(!1);M(async()=>{p.value=!0;try{await a.loadSession()}catch(l){console.log(l)}finally{setTimeout(()=>{p.value=!1},1e3)}});const h=async l=>{i.value=!0;const m=L(l.credential);try{await a.login(m)}catch(r){console.log(r)}finally{i.value=!1}};return(l,m)=>{const r=V,s=O,o=$;return n(),d(j,null,[y(K,{loading:p.value},null,8,["loading"]),t("main",X,[t("div",Y,[ee,t("section",ae,[u(a).isAuthenticated?c("",!0):(n(),v(u(C),{key:0,callback:h})),u(a).isAuthenticated?(n(),v(r,{key:1,onClick:m[0]||(m[0]=oe=>u(a).logout())},{default:k(()=>[f("Logout")]),_:1})):c("",!0),u(a).isAuthenticated?(n(),d("div",te,[f(w(u(a).user.given_name)+" ",1),y(s,{image:u(a).user.picture,alt:"User Avatar",shape:"circle"},null,8,["image"])])):c("",!0)]),t("section",se,[i.value?(n(),v(o,{key:0,mode:"indeterminate",style:{height:"6px"}})):c("",!0)])])])],64)}}},ce=S(re,[["__scopeId","data-v-d80008a2"]]);export{ce as default};
